---
title: "Gitを完全に理解する"
emoji: "🐥"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [github, git]
published: false
---
# Gitを完全に理解する
この記事では以下の内容をまとめておこうと思います
- gitそのものについて，
- gitのコマンド
---
## gitについて
### 1. gitはスナップショット
- 最初は全てのファイルを保存する.
- 変更が行われると，変更したファイルは差分ではなく，ファイル丸ごと保存する.
- 変更されてないものは，前回保存したものを使い回す.
->ブランチを導入するときにスナップショットだと都合がいい.差分計算だと複雑になっちゃう．歴史的にはもともと差分で開発されていたが，ブランチを切るのに時間がかかっていた．そこでリーナスさんがその問題を解決してgitを開発した．
---
### 2. バージョンをコミット(スナップショットの記録)で管理してる
- コミットnは直前のコミットn-1を記録して繋がってる
- コミットを辿っていけば古いバージョンまで遡れる
---
### 3. 言葉の定義
- リモート:オンラインのgithubとか
- コミット:スナップショットの記録，記録すること
- リモートリポジトリ:オンライン上の履歴データのデータベース(保管場所)みたいなもん
- ローカル:自分のパソコン．以下はローカルの
- ローカルリポジトリ:自分の手元の履歴データのデータベース
- ステージ:スナップショットを記録するための準備の場所．変更確定させたいファイルの変更情報だけを記録するため
- ワークツリー:自分が作業している場所
---
### 4. 流れ
(個人)
- ローカルのワークツリーで作業
- 変更があったら記録したいスナップショットをステージへ
- ステージからローカルリポジトリに記録(コミット)
- github(リモートリポジトリ)にアップロード
(チーム)
- github(リモートリポジトリ)から他の人の履歴をローカルリポジトリに取得
- 変更を自分のワークツリーに反映
- 変更したら(個人)の流れでアップロード
---
### 5. 中で起こっていること
- ユーザがステージング
- 先にリポジトリに圧縮ファイルが作られる
- ステージにはその圧縮ファイル名(ハッシュID)とファイル実態の組み合わせがインデックスとして保存される
- ユーザがコミットするとリポジトリにツリーが作らる
- その際ツリー情報や作成者，日付，メッセージなどをまとめたコミット情報を持ったファイルも作成される
->ステージにはインデックス情報が保存される
　リポジトリには圧縮ファイル，ツリー，コミット情報のファイルが保存される．実態は.git/objectsにある

- 追加の変更が起こったときは同様に圧縮ファイルが作られ，インデックスに構成が追加される
- リポジトリに新しい変更が加えられたツリーが作成される
- この時のコミット情報にはその前のコミットが親コミットとして保存される(変更履歴が辿れる)
---

## 初期設定,確認
バージョン確認．何も出ない時は公式からダウンロード
```terminal.
$ git version
```
初期設定(ユーザーネーム，email,エディターの登録，確認)
```terminal.
$ git config --global user.name [githubのユーザーネーム]
$ git config --global user.email [githubに登録したemail]
<!-- VSCodeは [code --wait]-->
$ git config --global core.editor [使用するエディター名]
```
確認
```terminal.
$ git config user.name
$ git config user.email
$ git config core.editor
<!-- 全部見たい時はこれ -->
$ git config --list
```
configファイルの実態
```terminal
$ cat ~/.gitconfig
```
---

## 実際にgitを触る
### リポジトリの作成
(個人)まずはリポジトリの作成．.gitディレクトリが作成される．この中にgit関係のファイルが作成されてく
```
$ git init
```
(チーム)リモートリポジトリから他の人が作成したプロジェクトのコピーを作成する．これをやると編集対象のファイルそのものとチームの.gitディレクトリがコピーされる
```
$ git clone [リポジトリ名]
```
### ステージに変更を追加
ワークツリーからステージに変更を追加.以下のコマンドで記録したいものだけ選択して追加できる
```
$ git add [ファイル名]
$ git add [ディレクトリ名]
<!-- 全部追加 -->
$ git add .
```
### ローカルリポジトリにコミット
変更を記録する．メッセージをエディター使わず書きたい時は-mオプション．ファイルの変更内容まで見たい時は-vオプション
```
$ git commit
$ git commit -m "[メッセージ]"
$ git commit -v
```
※コミットメッセージの書き方:
(個人)1行で変更内容と理由を書くのが望ましい
(チーム，正式)1行目:変更内容の要約，2行目:空行, 3行目変更した理由　

### 変更状況の確認
どのファイルが変更されたのかを確認
- ワークツリーとステージ間
- ステージとリポジトリ間
```
$ git status
```